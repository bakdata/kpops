---
apiVersion: batch/v1
kind: Job
metadata:
  annotations:
    argocd.argoproj.io/hook: PostDelete
  labels:
    app: resources-streams-bootstrap-argo-my-streams-app-clean
    chart: streams-app-cleanup-job-3.0.2
    release: resources-streams-bootstrap-argo-my-streams-app-clean
  name: resources-streams-bootstrap-argo-my-streams-app-clean
spec:
  backoffLimit: 6
  template:
    metadata:
      labels:
        app: resources-streams-bootstrap-argo-my-streams-app-clean
        release: resources-streams-bootstrap-argo-my-streams-app-clean
    spec:
      containers:
      - args:
        - reset
        env:
        - name: ENV_PREFIX
          value: APP_
        - name: KAFKA_LARGE_MESSAGE_ID_GENERATOR
          value: com.bakdata.kafka.MurmurHashIdGenerator
        - name: APP_BOOTSTRAP_SERVERS
          value: http://k8kafka-cp-kafka-headless.kpops.svc.cluster.local:9092
        - name: APP_SCHEMA_REGISTRY_URL
          value: http://localhost:8081/
        - name: APP_INPUT_TOPICS
          value: producer-1-output-topic
        - name: APP_INPUT_PATTERN
          value: my-input-pattern
        - name: APP_OUTPUT_TOPIC
          value: streams-app-1-output-topic
        - name: APP_ERROR_TOPIC
          value: streams-app-1-error-topic
        - name: APP_LABELED_OUTPUT_TOPICS
          value: my-output-topic-label=streams-app-1-labeled-output-topic,
        - name: APP_LABELED_INPUT_TOPICS
          value: producer-1-labeled-topic-output=producer-1-labeled-topic-output,
        - name: APP_LABELED_INPUT_PATTERNS
          value: my-input-topic-labeled-pattern=my-labeled-input-pattern,
        - name: APP_APPLICATION_ID
          value: my-streams-app-id
        - name: APP_CONVERT_XML
          value: 'true'
        - name: JAVA_TOOL_OPTIONS
          value: '-XX:MaxRAMPercentage=75.0 '
        image: my-registry/my-streams-app-image:1.0.0
        imagePullPolicy: Always
        name: resources-streams-bootstrap-argo-my-streams-app-clean
        resources:
          limits:
            cpu: 500m
            memory: 2G
          requests:
            cpu: 200m
            memory: 300Mi
      restartPolicy: OnFailure
  ttlSecondsAfterFinished: 30

---
apiVersion: batch/v1
kind: Job
metadata:
  labels:
    app: resources-streams-bootstrap-argo-my-producer-app-clean
    chart: producer-app-cleanup-job-3.0.2
    release: resources-streams-bootstrap-argo-my-produ-90b22-clean
  name: resources-streams-bootstrap-argo-my-producer-app-clean
spec:
  backoffLimit: 6
  template:
    metadata:
      labels:
        app: resources-streams-bootstrap-argo-my-producer-app-clean
        release: resources-streams-bootstrap-argo-my-produ-90b22-clean
    spec:
      containers:
      - args:
        - clean
        env:
        - name: ENV_PREFIX
          value: APP_
        - name: APP_BOOTSTRAP_SERVERS
          value: http://k8kafka-cp-kafka-headless.kpops.svc.cluster.local:9092
        - name: APP_SCHEMA_REGISTRY_URL
          value: http://localhost:8081/
        - name: APP_OUTPUT_TOPIC
          value: producer-1-output-topic
        - name: APP_LABELED_OUTPUT_TOPICS
          value: producer-1-labeled-topic-output=producer-1-labeled-topic-output,
        - name: APP_FAKE_ARG
          value: fake-arg-value
        - name: JAVA_TOOL_OPTIONS
          value: '-XX:MaxRAMPercentage=75.0 '
        image: my-registry/my-producer-image:1.0.0
        imagePullPolicy: Always
        name: resources-streams-bootstrap-argo-my-producer-app-clean
        resources:
          limits:
            cpu: 500m
            memory: 2G
          requests:
            cpu: 200m
            memory: 300Mi
      restartPolicy: OnFailure
  ttlSecondsAfterFinished: 30

